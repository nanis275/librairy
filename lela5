Sub CopyEmailBodyToExcelWithPause()
    ' Déclaration des objets Outlook et Word
    Dim objOutlook As Outlook.Application
    Dim objMail As Outlook.MailItem
    Dim wdDoc As Object ' Word.Document pour le corps de l'email
    Dim oXLApp As Object
    Dim oXLwb As Object
    Dim oXLws As Object

    ' Obtenir l'instance d'Outlook et sélectionner l'e-mail
    Set objOutlook = GetObject(, "Outlook.Application")

    If objOutlook.ActiveExplorer.Selection.Count = 0 Then
        MsgBox "Aucun e-mail sélectionné.", vbExclamation
        Exit Sub
    End If
    
    Set objMail = objOutlook.ActiveExplorer.Selection.Item(1)

    ' Ouvrir l'e-mail dans un inspecteur pour accéder au contenu
    Set wdDoc = objMail.GetInspector.WordEditor

    ' Vérifier que wdDoc est bien un document Word
    If TypeName(wdDoc) <> "Document" Then
        MsgBox "Le corps de l'e-mail n'est pas un document Word.", vbExclamation
        Exit Sub
    End If

    ' Sélectionner et copier le contenu de l'e-mail
    wdDoc.Content.Select
    wdDoc.Application.Selection.Copy ' Copier dans le presse-papier

    ' Ouvrir Excel et coller le contenu
    On Error Resume Next
    Set oXLApp = GetObject(, "Excel.Application")
    If oXLApp Is Nothing Then
        Set oXLApp = CreateObject("Excel.Application")
    End If
    On Error GoTo 0

    ' Vérifier qu'Excel est ouvert
    If oXLApp Is Nothing Then
        MsgBox "Veuillez ouvrir Excel manuellement avant d'exécuter la macro.", vbExclamation
        Exit Sub
    End If

    ' Rendre Excel visible
    oXLApp.Visible = True

    ' Utiliser le classeur actif
    Set oXLwb = oXLApp.ActiveWorkbook
    If oXLwb Is Nothing Then
        MsgBox "Aucun classeur n'est ouvert dans Excel.", vbExclamation
        Exit Sub
    End If

    ' Utiliser la première feuille de calcul
    Set oXLws = oXLwb.Sheets(1)

    ' Attendre une seconde avant de coller (pour éviter tout problème de timing)
    Application.Wait (Now + TimeValue("00:00:01"))

    ' Coller à partir de la cellule A1 en utilisant PasteSpecial
    oXLws.Range("A1").PasteSpecial Paste:=xlPasteAll

    MsgBox "Le contenu a été collé dans Excel."
End Sub
