Sub UseExistingExcel()

    Dim oXLApp As Object
    
    ' Essayer d'accéder à une instance Excel existante sans en créer une nouvelle
    On Error Resume Next
    Set oXLApp = GetObject(, "Excel.Application")
    On Error GoTo 0
    
    ' Vérifier si l'instance a été trouvée
    If oXLApp Is Nothing Then
        MsgBox "Veuillez ouvrir Excel manuellement avant d'exécuter la macro.", vbExclamation
        Exit Sub
    End If
    
    ' Rendre Excel visible si trouvé
    oXLApp.Visible = True
    MsgBox "Instance Excel trouvée et rendue visible."
    
    ' Nettoyer les objets
    Set oXLApp = Nothing

End Sub
